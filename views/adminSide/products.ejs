<%- include("sidebar.ejs") %>
<!-- Page Content -->
<%- include("header.ejs")%>

<!-- Products Section -->
<section id="products" class="content-section active">
  <div class="container">
    <h2>Add New Product</h2>
    <form id="addProductForm" enctype="multipart/form-data">
      <!-- Product Name -->
      <div class="form-group">
        <label for="productName">Product Name</label>
        <input
          type="text"
          id="productName"
          name="name"
          placeholder="Enter product name"
          required
        />
      </div>

      <!-- Product Price -->
      <div class="form-group">
        <label for="productPrice">Product Price ($)</label>
        <input
          type="number"
          id="productPrice"
          name="price"
          placeholder="Enter product price"
          step="0.01"
          min="0"
          required
        />
      </div>

      <!-- Product Category -->
      <div class="form-group">
        <label for="productCategory">Category</label>
        <select id="productCategory" name="category" required>
          <% if (categories.length > 0){ %>
          <option selected disabled>Select category</option>
          <% categories.forEach((category,index)=>{ %>
          <option value="<%= category.name  %>"><%= category.name %></option>

          <% }) %> <% }else{ %>
          <option selected disabled>NO categories available</option>
          <% }%>
          <!-- <option value="clothing">Clothing</option>
          <option value="home">Home Appliances</option>
          <option value="books">Books</option> -->
        </select>
      </div>

      <!-- Product Image Upload -->
      <div class="form-group">
        <label for="productImage">Upload Product Image</label>
        <input
          type="file"
          id="productImage"
          name="image"
          accept="image/*"
          required
        />
      </div>

      <!-- Product Description -->
      <div class="form-group">
        <label for="productDescription">Description</label>
        <textarea
          id="productDescription"
          name="description"
          rows="4"
          placeholder="Enter product description"
          required
        ></textarea>
      </div>

      <!-- Stock Quantity -->
      <div class="form-group">
        <label for="productStock">Stock Quantity</label>
        <input
          type="number"
          id="productStock"
          name="stock"
          placeholder="Enter stock quantity"
          min="0"
          required
        />
      </div>

      <!-- Error message -->
      <div>
        <input type="text" id="category-name" placeholder="Category Name" />
        <p style="display: none; color: red" id="errorMsg">
          Category already exists
        </p>
      </div>
      <!-- Submit Button -->
      <button type="submit">Add Product</button>
    </form>
  </div>
</section>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const form = document.getElementById("addProductForm");
    form.document.addEventListener("submit", (event) => {
      event.preventDefault();

      const productInputName = document
        .getElementById("productName")
        .value.trim();
      const productPrice = document.getElementById("productPrice");
      const productCategory = document.getElementById("productCategory");
      const productImage = document.getElementById("productImage").files[0];
      const productDescription = document
        .getElementById("productDescription")
        .value.trim();
      const productStockQuantity = document.getElementById("productStock");

      if (
        !productInputName ||
        !productPrice ||
        !productCategory ||
        !productImage ||
        !productDescription ||
        !productStockQuantity
      ) {
        document.getElementById("errorMsg").style.display = "block";
        alert("Please fill out all required fields and upload an image.");
        return;
      }
      const productData = {
        name : productInputName,
        price : productPrice,
        category : productCategory,
        image : productImage,
        description : productDescription,
        stockQuantity : productStockQuantity
      }
    });
  });
</script>

<%- include("footer.ejs")%>
